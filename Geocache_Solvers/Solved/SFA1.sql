
/* 
    Clean Up New Table
*/
SELECT *
FROM   SFA1_COL20TO22
WHERE  WORD LIKE '%.%'
/
DELETE
FROM   SFA1_COL20TO22
WHERE  WORD LIKE '%.%'
/

--  1626624	156155904
SELECT length(A.Word), length(B.Word), Count(*) * 36
FROM       SFA1_COL20TO22 A
CROSS JOIN SFA1_COL24TO25 B
GROUP BY length(A.Word), length(B.Word)
/


/*
   Trim New Table
*/

SELECT Count(*) * 168 FROM SFA1_COL20TO22 ;
SELECT substr(WORD, 1, 1), Count(*) FROM SFA1_COL20TO22 GROUP BY substr(WORD, 1, 1) ORDER BY 2 desc, 1;

DELETE FROM SFA1_COL20TO22 WHERE WORD LIKE 'T%'
AND WORD NOT IN (
'TO!',
'TI!',
'TAG',
'TAE',
'TAD',
'TAB'
)
/

DELETE FROM SFA1_COL20TO22
WHERE WORD NOT IN (SELECT LINE8_COLS22_26 FROM SFA1_FINAL);

/* 
    Insert New Entries
*/

INSERT INTO SFA1_FINAL 
 (LINE1_COLS01_03,  LINE1_COLS05_07,  LINE1_COLS09_13,  LINE1_COLS15_17,  LINE1_COLS19_22,  LINE1_COLS24_26,
  LINE2_COLS02_06,  LINE2_COLS08_12,  LINE2_COLS14_16,  LINE2_COLS18_18,  LINE2_COLS20_25,
  LINE3_COLS01_04,  LINE3_COLS06_10,  LINE3_COLS12_16,  LINE3_COLS18_21,  LINE3_COLS23_26,
  LINE4_COLS02_05,  LINE4_COLS07_09,  LINE4_COLS11_19,  LINE4_COLS21_21,  LINE4_COLS23_25,
  LINE5_COLS01_04,  LINE5_COLS06_09,  LINE5_COLS11_15,  LINE5_COLS17_18,  LINE5_COLS20_22,  LINE5_COLS24_25,
  LINE6_COLS01_05,  LINE6_COLS07_12,  LINE6_COLS14_16,  LINE6_COLS18_20,  LINE6_COLS22_23,  LINE6_COLS25_25,
  LINE7_COLS01_07,  LINE7_COLS09_13,  LINE7_COLS15_20,  LINE7_COLS22_26,
  LINE8_COLS01_01,  LINE8_COLS03_06,  LINE8_COLS08_10,  LINE8_COLS12_16,  LINE8_COLS18_20,  LINE8_COLS22_26,
  LINE9_COLS02_10,  LINE9_COLS12_18,  LINE9_COLS20_26)
SELECT 
  LINE1_COLS01_03,  LINE1_COLS05_07,  LINE1_COLS09_13,  LINE1_COLS15_17,  LINE1_COLS19_22,  LINE1_COLS24_26,
  LINE2_COLS02_06,  LINE2_COLS08_12,  LINE2_COLS14_16,  LINE2_COLS18_18,  LINE2_COLS20_25,
  LINE3_COLS01_04,  LINE3_COLS06_10,  LINE3_COLS12_16,  LINE3_COLS18_21,  LINE3_COLS23_26,
  LINE4_COLS02_05,  LINE4_COLS07_09,  LINE4_COLS11_19,  LINE4_COLS21_21,  LINE4_COLS23_25,
  LINE5_COLS01_04,  LINE5_COLS06_09,  LINE5_COLS11_15,  LINE5_COLS17_18,  A.WORD,           B.WORD,
  LINE6_COLS01_05,  LINE6_COLS07_12,  LINE6_COLS14_16,  LINE6_COLS18_20,  LINE6_COLS22_23,  LINE6_COLS25_25,
  LINE7_COLS01_07,  LINE7_COLS09_13,  LINE7_COLS15_20,  LINE7_COLS22_26,
  LINE8_COLS01_01,  LINE8_COLS03_06,  LINE8_COLS08_10,  LINE8_COLS12_16,  LINE8_COLS18_20,  LINE8_COLS22_26,
  LINE9_COLS02_10,  LINE9_COLS12_18,  LINE9_COLS20_26
FROM SFA1_FINAL 
 CROSS JOIN SFA1_COL20TO22 A
 CROSS JOIN SFA1_COL24TO25 B
/

UPDATE SFA1_FINAL 
SET    LINE2_COLS18_18 = '.',
       LINE4_COLS21_21 = '.'
/

/* 
    Clean up New Entries
*/
SELECT   substr(LINE5_COLS20_22, 1, 1), substr(LINE5_COLS24_25, 1, 1), Count(*) FROM SFA1_FINAL
GROUP BY substr(LINE5_COLS20_22, 1, 1), substr(LINE5_COLS24_25, 1, 1);

DELETE FROM     SFA1_FINAL 
WHERE LINE5_COLS20_22 Like 'x%'
/

DELETE 
FROM   V_SFA1_FINAL
WHERE  SFA1.Check_Limits(Line1, Line2, Line3, Line4, Line5, Line6, Line7, Line8, Line9) != 'OK'
/

/* 
    Compact Table 
*/
RENAME  SFa1_final to tmp_SFa1_final;
create table SFa1_final AS (SELECT * FROM TMP_SFa1_final);
DROP TABLE tmp_SFa1_final purge;

/* 
    Check up New Entries
*/

SELECT   substr(LINE5_COLS20_22, 1, 2), Count(*)
FROM     SFA1_FINAL 
Group By substr(LINE5_COLS20_22, 1, 2)
ORDER BY 2 Desc, 1
/
DELETE  FROM   SFA1_FINAL 
Where  LINE5_COLS20_22 LIKE 'SE%'
And    LINE5_COLS20_22 Not IN (
'SEZ!',
'SEY!',
'SEIK',
'SEAM',
'SEAL'
)
/


SELECT   LINE5_COLS20_22, Count(*)
FROM     SFA1_FINAL 
Group By LINE5_COLS20_22
Order By LINE5_COLS20_22
/


/* 
    Quick Review
*/

SELECT Line1, count(*) FROM V_SFA1_FINAL Group By Line1 ORDER BY Count(*) Desc; --   1
SELECT Line2, count(*) FROM V_SFA1_FINAL Group By Line2 ORDER BY Count(*) Desc; --   1
SELECT Line3, count(*) FROM V_SFA1_FINAL Group By Line3 ORDER BY Count(*) Desc; --   1
SELECT Line4, count(*) FROM V_SFA1_FINAL Group By Line4 ORDER BY Count(*) Desc; --   1
SELECT Line5, count(*) FROM V_SFA1_FINAL Group By Line5 ORDER BY Count(*) Desc; --   1
SELECT Line6, count(*) FROM V_SFA1_FINAL Group By Line6 ORDER BY Count(*) Desc; --   1
SELECT Line7, count(*) FROM V_SFA1_FINAL Group By Line7 ORDER BY Count(*) Desc; --   2
SELECT Line8, count(*) FROM V_SFA1_FINAL Group By Line8 ORDER BY Count(*) Desc; --   2
SELECT Line9, count(*) FROM V_SFA1_FINAL Group By Line9 ORDER BY Count(*) Desc; --   1
SELECT * FROM V_SFA1_FINAL;

SELECT Line6, count(*) FROM V_SFA1_FINAL WHERE LINE6 like '% OF %' Group By Line6 ORDER BY Count(*) Desc; --   126

DELETE FROM V_SFA1_FINAL
Where Line8 LIKE '% POST%';

/
SELECT * FROM V_SFA1_FINAL;
